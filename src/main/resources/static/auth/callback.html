<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>OAuth2 Callback</title>
</head>
<body>
<p>Processing...</p>
<script>
    window.onload = function() {
        // 1. URL에서 토큰 파라미터를 추출
        const params = new URLSearchParams(window.location.search);
        const accessToken = params.get('accessToken');
        const refreshToken = params.get('refreshToken');

        if (accessToken && refreshToken) {
            // 2. 토큰을 로컬 스토리지에 저장
            localStorage.setItem('accessToken', accessToken);
            localStorage.setItem('refreshToken', refreshToken);

            // 3. Authorization 헤더에 Bearer 토큰 추가
            const headers = new Headers();
            headers.append("Authorization", "Bearer " + accessToken);

            // 4. fetch로 API 요청 보내기
            fetch("http://3.36.148.255:8080/your-api-endpoint", {
                method: 'GET',
                headers: headers
            })
            .then(response => response.json())
            .then(data => console.log(data))
            .catch(error => console.error('Error:', error));

            // 5. 저장이 완료되면 메인 페이지로 리다이렉트
            window.location.href = '/';  // 메인 페이지 URL로 리다이렉트
        } else {
            // 6. 토큰이 없는 경우 에러 처리
            alert('로그인에 실패하였습니다. 다시 시도해주세요.');
            window.location.href = '/';  // 메인 페이지로 리다이렉트
        }
    };
</script>
</body>
</html>

